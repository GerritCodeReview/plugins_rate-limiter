{
  "comments": [
    {
      "key": {
        "uuid": "43f060e5_3b4a7f05",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 12,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-12T20:18:33Z",
      "side": 1,
      "message": "introduced",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 9
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b720eeb_9f327807",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 17,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-12T20:18:33Z",
      "side": 1,
      "message": "limits",
      "range": {
        "startLine": 17,
        "startChar": 48,
        "endLine": 17,
        "endChar": 53
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eadbe065_7b6b43fd",
        "filename": "WORKSPACE",
        "patchSetId": 5
      },
      "lineNbr": 6,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-13T18:44:47Z",
      "side": 1,
      "message": "0cdf281f110834b71ae134afe0a7e3fe346f0078\n\u003c\u003d\u003e\n2.14.15 -by now.",
      "range": {
        "startLine": 6,
        "startChar": 14,
        "endLine": 6,
        "endChar": 54
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fd4e297_17d49587",
        "filename": "WORKSPACE",
        "patchSetId": 5
      },
      "lineNbr": 6,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eadbe065_7b6b43fd",
      "range": {
        "startLine": 6,
        "startChar": 14,
        "endLine": 6,
        "endChar": 54
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d47f9a34_0f89bc4c",
        "filename": "bazlets.bzl",
        "patchSetId": 5
      },
      "lineNbr": 1,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-13T18:44:47Z",
      "side": 1,
      "message": "load(\"@bazel_tools//tools/build_defs/repo:git.bzl\", \"git_repository\")\n\nNAME \u003d \"com_googlesource_gerrit_bazlets\"\n\n-This comment goes with the one below, about replacing native.git_repository with the skylark rule. Explanation from similar commits in other plugins:\n\n\"The native.git_repository rule does not work properly when invoked in a `git submodule foreach` command. Bazel will deprecate the native rules anyway, so replace with skylark\u0027s git_repository. See [1] for context.\n[1] https://github.com/bazelbuild/bazel/issues/6358#issuecomment-429103745\".",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2c360781_059eecd1",
        "filename": "bazlets.bzl",
        "patchSetId": 5
      },
      "lineNbr": 1,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d47f9a34_0f89bc4c",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdcee217_401ba61a",
        "filename": "bazlets.bzl",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-13T18:44:47Z",
      "side": 1,
      "message": "git_repository(\n\n(Relates to above companion comment.)",
      "range": {
        "startLine": 7,
        "startChar": 8,
        "endLine": 7,
        "endChar": 30
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0bc80be2_a54887b7",
        "filename": "bazlets.bzl",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fdcee217_401ba61a",
      "range": {
        "startLine": 7,
        "startChar": 8,
        "endLine": 7,
        "endChar": 30
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ca27f751_12b1a461",
        "filename": "external_plugin_deps.bzl",
        "patchSetId": 5
      },
      "lineNbr": 6,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-13T18:44:47Z",
      "side": 1,
      "message": "2.23.0 is the latest version that is currently being set in the other plugins.",
      "range": {
        "startLine": 6,
        "startChar": 45,
        "endLine": 6,
        "endChar": 51
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd56fc75_86eb4cc9",
        "filename": "external_plugin_deps.bzl",
        "patchSetId": 5
      },
      "lineNbr": 6,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ca27f751_12b1a461",
      "range": {
        "startLine": 6,
        "startChar": 45,
        "endLine": 6,
        "endChar": 51
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "47275680_ede851e3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/HourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 53,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-10-15T09:59:45Z",
      "side": 1,
      "message": "There is still a race condition here, between this code and the code in the replenishPermits method. What could happen is:\n* the replenishPermits method releases all used permits (line 74)\n* one or more threads successfully acquire permits (line 50) and increases usedPermits\n* the \"replenish\" thread then continues and sets usedPermits to zero (line 75)\n\nAlthough both the semaphore and usedPermits variables are individually thread safe, they\nare not updated together in a thread safe manner here... so they can run out of sync.",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42bb7fb8_93704a72",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/HourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 53,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "47275680_ede851e3",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3cd9d9ec_d9bd29d8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/HourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-10-15T09:59:45Z",
      "side": 1,
      "message": "This should be exactly usedPermits, so why not use that here?",
      "range": {
        "startLine": 74,
        "startChar": 22,
        "endLine": 74,
        "endChar": 63
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c0ca1248_a40088d9",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/HourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 74,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3cd9d9ec_d9bd29d8",
      "range": {
        "startLine": 74,
        "startChar": 22,
        "endLine": 74,
        "endChar": 63
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "017681ed_82f04975",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/WarningHourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-10-15T09:59:45Z",
      "side": 1,
      "message": "This is not thread safe. Assume: usedPermits \u003d 49, warnLimit \u003d 50.\n* thread T1 acquires permit (line 61), usedPermits is increased to 50\n* thread T2 acquires permit (line 61), usedPermits is increased to 51\n* thread T1 proceeds to this line and the condition is false\n* thread T2 proceeds to this line and the condition is false\n* no warning is produced",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65b67698_da4a9c31",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/WarningHourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Hi Sasa\n\nThanks for the review. Maybe I\u0027m missing something, but my understanding is that by using the synchronized keyword, the monitor lock for the object is held by the current thread until the function is complete. So I don\u0027t understand how this scenario could happen\n\n\u003e This is not thread safe. Assume: usedPermits \u003d 49, warnLimit \u003d 50.\n\u003e * thread T1 acquires permit (line 61), usedPermits is increased to 50\n\nok\n\n\u003e * thread T2 acquires permit (line 61), usedPermits is increased to 51\n\nAgain, I don\u0027t see how this can happen as this thread must wait until the first thread releases the object monitor lock (exits the function)\n\n\u003e * thread T1 proceeds to this line and the condition is false\n\u003e * thread T2 proceeds to this line and the condition is false\n\u003e * no warning is produced",
      "parentUuid": "017681ed_82f04975",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d89b306_b2bfdd7a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/ratelimiter/WarningHourlyRateLimiter.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-10-16T20:12:59Z",
      "side": 1,
      "message": "No you are not missing anything, I overlooked the synchronized keyword. Sorry.",
      "parentUuid": "65b67698_da4a9c31",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3cb2c17e_82b2e234",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 5
      },
      "lineNbr": 16,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-12T20:18:33Z",
      "side": 1,
      "message": "uploadpackperhourwarn \u003d 8",
      "range": {
        "startLine": 16,
        "startChar": 4,
        "endLine": 16,
        "endChar": 27
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b30e9bae_73b71aca",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 5
      },
      "lineNbr": 16,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3cb2c17e_82b2e234",
      "range": {
        "startLine": 16,
        "startChar": 4,
        "endLine": 16,
        "endChar": 27
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "113ebda6_68c81a84",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-12T20:18:33Z",
      "side": 1,
      "message": "Missing 1 space indent.",
      "range": {
        "startLine": 25,
        "startChar": 0,
        "endLine": 25,
        "endChar": 3
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6972e472_fee4665a",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "113ebda6_68c81a84",
      "range": {
        "startLine": 25,
        "startChar": 0,
        "endLine": 25,
        "endChar": 3
      },
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8beaba22_4ab10eaf",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1012732
      },
      "writtenOn": "2018-10-12T20:18:33Z",
      "side": 1,
      "message": "Extra blank line added I think; would remove it.",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74946373_3750ae46",
        "filename": "src/main/resources/Documentation/config.md",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1071622
      },
      "writtenOn": "2018-10-16T18:40:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8beaba22_4ab10eaf",
      "revId": "ac3030672e1736d44cc2737b918428a99b386b1d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}